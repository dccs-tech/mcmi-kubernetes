parents:
  - module: cluster
    profile: aws-network

config:
  kube_master_subnet_cidr_prefix: 28
  kube_master_subnet_public_ip: False
  kube_master_groups:
    - k8s-cluster
    - kube-master

  aws_kube_master_subnets:
    - kube-master-1
    - kube-master-2

  aws_kube_master_firewalls:
    - internet
    - ssh

  aws_kube_master_machine: t2.micro
  aws_kube_master_tenancy: default
  aws_kube_master_monitoring: false
  aws_kube_master_ebs_type: gp2
  aws_kube_master_ebs_size: 10
  aws_kube_master_ebs_iops: null
  aws_kube_master_ebs_optimized: false
  aws_kube_master_ebs_encrypted: false

  kube_node_subnet_cidr_prefix: 20
  kube_node_subnet_public_ip: False
  kube_node_groups:
    - k8s-cluster
    - kube-node

  aws_kube_node_subnets:
    - kube-node-1
    - kube-node-2

  aws_kube_master_firewalls:
    - internet
    - ssh

  aws_kube_node_machine: t2.micro
  aws_kube_node_tenancy: default
  aws_kube_node_monitoring: false
  aws_kube_node_ebs_type: gp2
  aws_kube_node_ebs_size: 10
  aws_kube_node_ebs_iops: null
  aws_kube_node_ebs_optimized: false
  aws_kube_node_ebs_encrypted: false

group:
  etcd:
  kube-master:
  kube-node:
  k8s-cluster:
    - kube-master
    - kube-node

subnet:
  kube-master-1:
    network: "@aws_networks"
    cidr_prefix: "@kube_master_subnet_cidr_prefix"
    zone_suffix: a
    use_public_ip: "@kube_master_subnet_public_ip"
    groups: "@kube_master_groups"

  kube-master-2:
    network: "@aws_networks"
    cidr_prefix: "@kube_master_subnet_cidr_prefix"
    zone_suffix: b
    use_public_ip: "@kube_master_subnet_public_ip"
    groups: "@kube_master_groups"

  kube-node-1:
    network: "@aws_networks"
    cidr_prefix: "@kube_node_subnet_cidr_prefix"
    zone_suffix: a
    use_public_ip: "@kube_node_subnet_public_ip"
    groups: "@kube_node_groups"

  kube-node-2:
    network: "@aws_networks"
    cidr_prefix: "@kube_node_subnet_cidr_prefix"
    zone_suffix: b
    use_public_ip: "@kube_node_subnet_public_ip"
    groups: "@kube_node_groups"

server:
  kube-master:
    count: 1
    provider: ec2
    network: "@aws_networks"
    subnet: "@aws_kube_master_subnets"
    image: "@aws_ubuntu_image[network]"
    user: "@aws_ubuntu_user"
    machine: "@aws_kube_master_machine"
    use_public_ip: false
    tenancy: "@aws_kube_master_tenancy"
    monitoring: "@aws_kube_master_monitoring"
    ebs_type: "@aws_kube_master_ebs_type"
    ebs_size: "@aws_kube_master_ebs_size"
    ebs_iops: "@aws_kube_master_ebs_iops"
    ebs_optimized: "@aws_kube_master_ebs_optimized"
    ebs_encrypted: "@aws_kube_master_ebs_encrypted"
    firewalls: "@aws_kube_master_firewalls"
    groups: "@kube_master_groups"

  kube-node:
    count: 3
    provider: ec2
    network: "@aws_networks"
    subnet: "@aws_kube_node_subnets"
    image: "@aws_ubuntu_image[network]"
    user: "@aws_ubuntu_user"
    machine: "@aws_kube_node_machine"
    use_public_ip: false
    tenancy: "@aws_kube_node_tenancy"
    monitoring: "@aws_kube_node_monitoring"
    ebs_type: "@aws_kube_node_ebs_type"
    ebs_size: "@aws_kube_node_ebs_size"
    ebs_iops: "@aws_kube_node_ebs_iops"
    ebs_optimized: "@aws_kube_node_ebs_optimized"
    ebs_encrypted: "@aws_kube_node_ebs_encrypted"
    firewalls: "@aws_kube_node_firewalls"
    groups: "@kube_node_groups"
